(function(){if(!this.require){var e={},r={},o=function(s,i){var u,c,a=t(i,s),l=t(a,"./index");if(u=r[a]||r[l])return u;if(c=e[a]||e[a=l])return u={id:a,exports:{}},r[a]=u.exports,c(u.exports,function(e){return o(e,n(a))},u),r[a]=u.exports;throw"module "+s+" not found"},t=function(e,r){var o,t,n=[];o=/^\.\.?(\/|$)/.test(r)?[e,r].join("/").split("/"):r.split("/");for(var s=0,i=o.length;i>s;s++)t=o[s],".."==t?n.pop():"."!=t&&""!=t&&n.push(t);return n.join("/")},n=function(e){return e.split("/").slice(0,-1).join("/")};this.require=function(e){return o(e,"")},this.require.define=function(r){for(var o in r)e[o]=r[o]},this.require.modules=e,this.require.cache=r}return this.require}).call(this),this.require.define({application:function(exports,require,module){(function(){var CoffeeScriptProcessor,ConsoleController,JavaScriptProcessor,WebSocketProcessor,_ref,__hasProp={}.hasOwnProperty,__extends=function(e,r){function o(){this.constructor=e}for(var t in r)__hasProp.call(r,t)&&(e[t]=r[t]);return o.prototype=r.prototype,e.prototype=new o,e.__super__=r.prototype,e},__bind=function(e,r){return function(){return e.apply(r,arguments)}};JavaScriptProcessor=function(){function JavaScriptProcessor(){}return JavaScriptProcessor.prototype.evaulate=function(source,success,failure){var e,result;try{return result=eval(source),success(result)}catch(_error){return e=_error,failure(e)}},JavaScriptProcessor}(),CoffeeScriptProcessor=function(e){function r(){return _ref=r.__super__.constructor.apply(this,arguments)}return __extends(r,e),r.prototype.evaulate=function(e,r,o){var t,n;try{return n=CoffeeScript.eval(e),r(n)}catch(s){return t=s,o(t)}},r}(JavaScriptProcessor),WebSocketProcessor=function(){function e(e,r,o){this.onReady=e,this.websocketUrl=r,null==o&&(o="ruby"),this.evaulate=__bind(this.evaulate,this),this.connect=__bind(this.connect,this),console.log("connect to websocket: "+r),this.language=o,this.connect()}return e.prototype.connect=function(){var e=this;return this.ws=new WebSocket(this.websocketUrl),this.ws.onopen=function(){return console.log("opened"),e.onReady()},this.ws.onmessage=function(r){var o,t;return console.log("event",r),o=r.data?JSON.parse(r.data):{status:"error",message:"no response"},o?"ok"!==o.status?"error"===o.status?(console.error("error, event=",r),t=o.message?o.message:"Unknown error: "+r,e.failedWithMessage(t)):(console.error("unknown error, event=",r),e.failedWithMessage("unknown error: "+r)):(console.log("command: ok"),e.success?(e.success(o.result),e.success=null):void 0):(console.error("unexpected data format",r),e.failedWithMessage("unexpected data format: "+r))},this.ws.onclose=function(){return e.failedWithMessage("Connection closed"),e.connect()},this.ws.onerror=function(r){return console.log("error",r),e.failedWithMessage("Unknown error: "+r)}},e.prototype.failedWithMessage=function(e){return this.failure?(this.failure(e),this.failure=null):void 0},e.prototype.evaulate=function(e,r,o){var t,n;return n={command:"eval",source:e,language:this.language},t=JSON.stringify(n),this.success=r,this.failure=o,this.ws.send(t)},e}(),ConsoleController=function(){function e(e,r){var o,t=this;this.jsConsole=$("#console").jqconsole("Connecting to "+e+"\n","> "),o=function(){return t.prompt()},this.processor=new WebSocketProcessor(o,e,r)}return e.prototype.prompt=function(){var e=this;return this.jsConsole.Prompt(!0,function(r){var o,t;return t=function(r){return e.jsConsole.Write(r+"\n","jqconsole-output"),e.prompt()},o=function(r){return e.jsConsole.Write(r+"\n","jqconsole-error"),e.prompt()},e.processor.evaulate(r,t,o)})},e}(),module.exports=function(){var e,r;return e="%%WEBSOCKET_URL%%","%%WEBSOCKET_URL%%"===e&&(e="ws://localhost:3300/context"),r=new ConsoleController(e,"ruby"),r.prompt()}}).call(this)}});