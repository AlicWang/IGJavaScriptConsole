(function(){if(!this.require){var e={},n={},o=function(s,i){var u,a,c=t(i,s),l=t(c,"./index");if(u=n[c]||n[l])return u;if(a=e[c]||e[c=l])return u={id:c,exports:{}},n[c]=u.exports,a(u.exports,function(e){return o(e,r(c))},u),n[c]=u.exports;throw"module "+s+" not found"},t=function(e,n){var o,t,r=[];o=/^\.\.?(\/|$)/.test(n)?[e,n].join("/").split("/"):n.split("/");for(var s=0,i=o.length;i>s;s++)t=o[s],".."==t?r.pop():"."!=t&&""!=t&&r.push(t);return r.join("/")},r=function(e){return e.split("/").slice(0,-1).join("/")};this.require=function(e){return o(e,"")},this.require.define=function(n){for(var o in n)e[o]=n[o]},this.require.modules=e,this.require.cache=n}return this.require}).call(this),this.require.define({application:function(e,n,o){(function(){var e,n,t=function(e,n){return function(){return e.apply(n,arguments)}};n=function(){function e(e,n,o,r,s){var i=this;null==n&&(n="ruby"),this.onReady=o,this.onMessage=r,this.onError=s,this.evaulate=t(this.evaulate,this),console.log("connect to websocket: "+e),this.ws=new WebSocket(e),this.language=n,this.ws.onopen=function(){return console.log("opened"),i.onReady()},this.ws.onmessage=function(e){var n,o;return console.log("event",e),n=e.data?JSON.parse(e.data):{status:"error",message:"no response"},n?"ok"!==n.status?"error"===n.status?(console.error("error, event=",e),o=n.message?n.message:"Unknown error: "+e,i.failedWithMessage(o)):"info"===n.status?(console.info("server: ",n.message),i.onMessage(n.message)):(console.error("unknown error, event=",e),i.failedWithMessage("unknown error: "+e)):(console.log("command: ok"),i.success?(i.success(n.result),i.success=null):void 0):(console.error("unexpected data format",e),i.failedWithMessage("unexpected data format: "+e))},this.ws.onclose=function(){return i.failedWithMessage("Connection closed")},this.ws.onerror=function(e){return console.log("error",e),i.failedWithMessage("Unknown error: "+e)}}return e.prototype.failedWithMessage=function(e){return this.failure?(this.failure(e),this.failure=null):this.onError(e)},e.prototype.evaulate=function(e,n,o){var t,r;return r={command:"eval",source:e,language:this.language},t=JSON.stringify(r),this.success=n,this.failure=o,this.ws.send(t)},e}(),e=function(){function e(e,o){this.onError=t(this.onError,this),this.onMessage=t(this.onMessage,this),this.onReady=t(this.onReady,this),this.jsConsole=$("#console").jqconsole("Connecting to "+e+"\n","> "),this.processor=new n(e,o,this.onReady,this.onMessage,this.onError)}return e.prototype.onReady=function(){return this.prompt()},e.prototype.onMessage=function(e){return this.jsConsole.Write(e+"\n","jqconsole-output")},e.prototype.onError=function(e){return this.jsConsole.Write(e+"\n","jqconsole-error")},e.prototype.prompt=function(){var e=this;return this.jsConsole.Prompt(!0,function(n){var o,t;return t=function(n){return e.onMessage(n),e.prompt()},o=function(n){return e.onError(n),e.prompt()},e.processor.evaulate(n,t,o)})},e}(),o.exports=function(){var n,o;return n="%%WEBSOCKET_URL%%",n.match("^%%WEBSOCKET_")&&(n="ws://localhost:3300/context"),o=new e(n,"ruby"),o.prompt()}}).call(this)}});