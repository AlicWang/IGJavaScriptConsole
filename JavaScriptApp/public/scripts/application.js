(function(){if(!this.require){var e={},t={},n=function(s,i){var u,a,c=o(i,s),l=o(c,"./index");if(u=t[c]||t[l])return u;if(a=e[c]||e[c=l])return u={id:c,exports:{}},t[c]=u.exports,a(u.exports,function(e){return n(e,r(c))},u),t[c]=u.exports;throw"module "+s+" not found"},o=function(e,t){var n,o,r=[];n=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/");for(var s=0,i=n.length;i>s;s++)o=n[s],".."==o?r.pop():"."!=o&&""!=o&&r.push(o);return r.join("/")},r=function(e){return e.split("/").slice(0,-1).join("/")};this.require=function(e){return n(e,"")},this.require.define=function(t){for(var n in t)e[n]=t[n]},this.require.modules=e,this.require.cache=t}return this.require}).call(this),this.require.define({console_ruby_helper:function(e,t,n){(function(){var e,t,o,r=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};t=function(){function t(){}return t.multiLineCallback=function(t){var n,s,i,u,a,c,l,h,f,p,d,g,m;for(u=0,c=0,n=0,s=0,i=0,g=t.split("\n"),h=0,p=g.length;p>h;h++)for(a=g[h],i=0,m=a.match(o)||[],f=0,d=m.length;d>f;f++)if(l=m[f],r.call(e,l)>=0?(u++,i++):"("===l?(c++,i++):"{"===l?(n++,i++):"["===l?(s++,i++):"end"===l?(u--,i--):")"===l?(c--,i--):"]"===l?(n--,i--):"}"===l&&(s--,i--),0>u||0>c||0>n||0>s)return!1;return u>0||c>0||n>0||s>0?i>0?i:0:!1},t}(),e=["begin","module","def","class","if","unless","case","for","while","until","do"],o=/\s+|\d+(?:\.\d*)?|"(?:[^"]|\\.)*"|'(?:[^']|\\.)*'|\/(?:[^\/]|\\.)*\/|[-+\/*]|[<>=]=?|:?[a-z@$][\w?!]*|[{}()\[\]]|[^\w\s]+/gi,n.exports=t}).call(this)}}),this.require.define({application:function(e,t,n){(function(){var e,o,r,s=function(e,t){return function(){return e.apply(t,arguments)}};o=t("console_ruby_helper"),r=function(){function e(e,t,n,o,r){var i=this;null==t&&(t="ruby"),this.onReady=n,this.onMessage=o,this.onError=r,this.evaulate=s(this.evaulate,this),console.log("connect to websocket: "+e),this.ws=new WebSocket(e),this.language=t,this.ws.onopen=function(){return console.log("opened"),i.onReady()},this.ws.onmessage=function(e){var t,n;return console.log("event",e),t=e.data?JSON.parse(e.data):{status:"error",message:"no response"},t?"ok"!==t.status?"error"===t.status?(console.error("error, event=",e),n=t.message?t.message:"Unknown error: "+e,i.failedWithMessage(n)):"info"===t.status?(console.info("server: ",t.message),i.onMessage(t.message)):(console.error("unknown error, event=",e),i.failedWithMessage("unknown error: "+e)):(console.log("command: ok"),i.success?(i.success(t.result),i.success=null):void 0):(console.error("unexpected data format",e),i.failedWithMessage("unexpected data format: "+e))},this.ws.onclose=function(){return i.failedWithMessage("Connection closed")},this.ws.onerror=function(e){return console.log("error",e),i.failedWithMessage("Unknown error: "+e)}}return e.prototype.failedWithMessage=function(e){return this.failure?(this.failure(e),this.failure=null):this.onError(e)},e.prototype.evaulate=function(e,t,n){var o,r;return r={command:"eval",source:e,language:this.language},o=JSON.stringify(r),this.success=t,this.failure=n,this.ws.send(o)},e}(),e=function(){function e(e,t){this.prompt=s(this.prompt,this),this.onError=s(this.onError,this),this.onMessage=s(this.onMessage,this),this.onReady=s(this.onReady,this),this.rubyMode=s(this.rubyMode,this),this.jsConsole=$("#console").jqconsole("Connecting to "+e+"\n","> ",".."),this.rubyMode(),this.processor=new r(e,t,this.onReady,this.onMessage,this.onError)}return e.prototype.rubyMode=function(){return this.jsConsole.SetIndentWidth(2),this.jsConsole.RegisterMatching("(",")"),this.jsConsole.RegisterMatching("[","]"),this.jsConsole.RegisterMatching("{","}")},e.prototype.onReady=function(){return this.prompt()},e.prototype.onMessage=function(e){return this.jsConsole.Write(e+"\n","jqconsole-output")},e.prototype.onError=function(e){return this.jsConsole.Write(e+"\n","jqconsole-error")},e.prototype.prompt=function(){var e,t=this;return e=function(e){var n,o;return o=function(e){return t.onMessage(e),t.prompt()},n=function(e){return t.onError(e),t.prompt()},t.processor.evaulate(e,o,n)},this.jsConsole.Prompt(!0,e,o.multiLineCallback,!1)},e}(),n.exports=function(){var t,n;return t="%%WEBSOCKET_URL%%",t.match("^%%WEBSOCKET_")&&(t="ws://localhost:3300/context"),n=new e(t,"ruby"),n.prompt()}}).call(this)}});