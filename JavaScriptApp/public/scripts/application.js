(function(){if(!this.require){var e={},t={},n=function(s,i){var u,a,l=o(i,s),c=o(l,"./index");if(u=t[l]||t[c])return u;if(a=e[l]||e[l=c])return u={id:l,exports:{}},t[l]=u.exports,a(u.exports,function(e){return n(e,r(l))},u),t[l]=u.exports;throw"module "+s+" not found"},o=function(e,t){var n,o,r=[];n=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/");for(var s=0,i=n.length;i>s;s++)o=n[s],".."==o?r.pop():"."!=o&&""!=o&&r.push(o);return r.join("/")},r=function(e){return e.split("/").slice(0,-1).join("/")};this.require=function(e){return n(e,"")},this.require.define=function(t){for(var n in t)e[n]=t[n]},this.require.modules=e,this.require.cache=t}return this.require}).call(this),this.require.define({console_multiline_handler:function(e,t,n){(function(){var e,t,o,r=function(e,t){return function(){return e.apply(t,arguments)}},s=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};t=function(){function t(e){this.multiLineCallback=r(this.multiLineCallback,this),this.language=e}return t.prototype.multiLineCallback=function(e){return"ruby"===this.language?this.rubyMultiLineCallback(e):!1},t.prototype.rubyMultiLineCallback=function(t){var n,r,i,u,a,l,c,h,f,p,d,g,m;for(u=0,l=0,n=0,r=0,i=0,g=t.split("\n"),h=0,p=g.length;p>h;h++)for(a=g[h],i=0,m=a.match(o)||[],f=0,d=m.length;d>f;f++)if(c=m[f],s.call(e,c)>=0?(u++,i++):"("===c?(l++,i++):"{"===c?(n++,i++):"["===c?(r++,i++):"end"===c?(u--,i--):")"===c?(l--,i--):"]"===c?(n--,i--):"}"===c&&(r--,i--),0>u||0>l||0>n||0>r)return!1;return u>0||l>0||n>0||r>0?i>0?i:0:!1},t}(),e=["begin","module","def","class","if","unless","case","for","while","until","do"],o=/\s+|\d+(?:\.\d*)?|"(?:[^"]|\\.)*"|'(?:[^']|\\.)*'|\/(?:[^\/]|\\.)*\/|[-+\/*]|[<>=]=?|:?[a-z@$][\w?!]*|[{}()\[\]]|[^\w\s]+/gi,n.exports=t}).call(this)}}),this.require.define({websocket_evaulator:function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,n,o,r,s){var i=this;null==n&&(n="ruby"),this.onReady=o,this.onMessage=r,this.onError=s,this.evaulate=t(this.evaulate,this),console.log("connect to websocket: "+e),this.ws=new WebSocket(e+("/eval/"+n)),this.language=n,this.ws.onopen=function(){return console.log("opened"),i.onReady()},this.ws.onmessage=function(e){var t,n;return console.log("event",e),t=e.data?JSON.parse(e.data):{status:"error",message:"no response"},t?"ok"!==t.status?"error"===t.status?(console.error("error, event=",e),n=t.message?t.message:"Unknown error: "+e,i.failedWithMessage(n)):"info"===t.status?(console.info("server: ",t.message),i.onMessage(t.message)):(console.error("unknown error, event=",e),i.failedWithMessage("unknown error: "+e)):(console.log("command: ok"),i.success?(i.success(t.result),i.success=null):void 0):(console.error("unexpected data format",e),i.failedWithMessage("unexpected data format: "+e))},this.ws.onclose=function(){return i.failedWithMessage("Connection closed")},this.ws.onerror=function(e){return console.log("error",e),i.failedWithMessage("Unknown error: "+e)}}return e.prototype.evaulate=function(e,t,n){var o,r;return r={command:"eval",source:e},o=JSON.stringify(r),this.success=t,this.failure=n,this.ws.send(o)},e.prototype.failedWithMessage=function(e){return this.failure?(this.failure(e),this.failure=null):this.onError(e)},e}(),n.exports=e}).call(this)}}),this.require.define({application:function(e,t,n){(function(){var e,o,r,s=function(e,t){return function(){return e.apply(t,arguments)}};o=t("console_multiline_handler"),r=t("websocket_evaulator"),e=function(){function e(e,t){var n=this;this.language=t,this.onError=s(this.onError,this),this.onMessage=s(this.onMessage,this),this.onReady=s(this.onReady,this),this.onInput=s(this.onInput,this),this.prompt=s(this.prompt,this),this.multiline=new o(this.language),this.evaulator=new r(e,t,this.onReady,this.onMessage,this.onError),this.jsConsole=$("#console").jqconsole("Connecting to "+e+"\n","> ",".."),this.jsConsole.SetIndentWidth(2),this.jsConsole.RegisterMatching("(",")"),this.jsConsole.RegisterMatching("[","]"),this.jsConsole.RegisterMatching("{","}"),this.editor=ace.edit("editor"),this.editor.setTheme("ace/theme/xcode"),this.editor.getSession().setMode("ace/mode/ruby"),this.editor.commands.addCommand({name:"evaulate",bindKey:{win:"Ctrl-Enter",mac:"Command-Enter"},exec:function(e){var t;return t=e.getValue(),n.jsConsole.Write(t+"\n","jqconsole-input"),n.onInput(t)},readOnly:!0})}return e.prototype.prompt=function(){return this.jsConsole.Prompt(!0,this.onInput,this.multiline.multiLineCallback,!1)},e.prototype.onInput=function(e){var t,n,o=this;return n=function(e){return o.onMessage(e),o.prompt()},t=function(e){return o.onError(e),o.prompt()},this.evaulator.evaulate(e,n,t)},e.prototype.onReady=function(){return this.prompt()},e.prototype.onMessage=function(e){return this.jsConsole.Write(e+"\n","jqconsole-output")},e.prototype.onError=function(e){return this.jsConsole.Write(e+"\n","jqconsole-error")},e}(),n.exports=function(){var t,n;return t="%%WEBSOCKET_URL%%",t.match("^%%WEBSOCKET_")&&(t="ws://localhost:3300"),n=new e(t,"ruby"),n.prompt()}}).call(this)}});